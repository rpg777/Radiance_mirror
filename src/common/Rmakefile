#
# SCCSid "$SunId$ LBL"
# Makefile for ray tracing library routines
#

OPT = -O
MACH = -DSTRUCTASSIGN -DBSD
CFLAGS = $(MACH) $(OPT)

COMPAT = bmalloc.o erf.o # frexp.o fwrite.o random.o

LIBDIR = /usr/local/lib/ray

RTOBJ = cone.o face.o instance.o readobj.o readoct.o otypes.o objset.o \
	octree.o readfargs.o modobject.o

PICOBJ = color.o header.o image.o lamps.o resolu.o rexpr.o spec_rgb.o \
	colrops.o 

STDOBJ = fgetline.o fropen.o linregr.o xf.o mat4.o fvect.o urand.o \
	urind.o peano.o calexpr.o caldefn.o calfunc.o calprnt.o \
	multisamp.o process.o getpath.o error.o savestr.o savqstr.o \
	fgetword.o words.o cputs.o wputs.o eputs.o quit.o

SYSOBJ = ealloc.o $(COMPAT)

librt.a:	$(RTOBJ) $(PICOBJ) $(STDOBJ) $(SYSOBJ)
	ar rc librt.a $(RTOBJ) $(PICOBJ) $(STDOBJ) $(SYSOBJ)
	-ranlib librt.a

install:	librt.a
	mv librt.a ../lib

clean:
	rm -f $(RTOBJ) $(PICOBJ) $(STDOBJ) $(SYSOBJ) librt.a

fropen.o:	fropen.c
	cc $(CFLAGS) -DDEFPATH=\":$(LIBDIR)\" -c fropen.c

calexpr.o:	calexpr.c calcomp.h
	cc $(CFLAGS) -DVARIABLE -DFUNCTION -DRCONST -c calexpr.c

caldefn.o:	caldefn.c calcomp.h
	cc $(CFLAGS) -DFUNCTION -c caldefn.c

calfunc.o:	calfunc.c calcomp.h
	cc $(CFLAGS) -DVARIABLE -DBIGLIB -c calfunc.c

color.o colrops.o resolu.o spec_rgb.o:	color.h

cone.o:		cone.h

face.o:		face.h

fvect.o:	fvect.h

instance.o:	instance.h

linregr.o:	linregr.h

mat4.o:		mat4.h fvect.h

cone.o face.o instance.o objset.o otypes.o \
modobject.o readobj.o readoct.o:	object.h

objset.o octree.o readoct.o:	octree.h

cone.o modobject.o objset.o otypes.o readobj.o readoct.o:	otypes.h

urand.o:	random.h

cone.o face.o image.o instance.o error.o objset.o octree.o modobject.o \
otypes.o readobj.o readoct.o xf.o:	standard.h mat4.h fvect.h

image.o:	view.h

calprnt.o:	calcomp.h
